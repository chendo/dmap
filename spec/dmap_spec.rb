require File.dirname(__FILE__) + '/spec_helper'

describe "dmap" do
  before do
    @dmap = DMAP::Parser.new
  end
  
  describe "parsing" do
    it "should parse without erroring" do
      puts DMAP::TAGS.values.map { |l| l.first }.join("\n")
      data = "msrv\000\000\001\bmstt\000\000\000\004\000\000\000\310mpro\000\000\000\004\000\002\000\005apro\000\000\000\004\000\003\000\aaeSV\000\000\000\004\000\003\000\000aeFP\000\000\000\001\001ated\000\000\000\002\000\003msed\000\000\000\001\001msml\000\000\000\020msma\000\000\000\b\000\000~\276a\214\036\000minm\000\000\000\022chendo\342\200\231s Librarymslr\000\000\000\001\001mstm\000\000\000\004\000\000\a\bmsal\000\000\000\001\001msas\000\000\000\001\003msup\000\000\000\001\001mspi\000\000\000\001\001msex\000\000\000\001\001msbr\000\000\000\001\001msqy\000\000\000\001\001msix\000\000\000\001\001msrs\000\000\000\001\001msdc\000\000\000\004\000\000\000\001mstc\000\000\000\004J@\267Gmsto\000\000\000\004\000\000\214\240"
      
      #data = "mccr\000\000\"1mstt\000\000\000\004\000\000\000\310mdcl\000\000\000)mcnm\000\000\000\004miidmcna\000\000\000\vdmap.itemidmcty\000\000\000\002\000\005mdcl\000\000\000+mcnm\000\000\000\004minmmcna\000\000\000\rdmap.itemnamemcty\000\000\000\002\000\tmdcl\000\000\000+mcnm\000\000\000\004mikdmcna\000\000\000\rdmap.itemkindmcty\000\000\000\002\000\001mdcl\000\000\000/mcnm\000\000\000\004mpermcna\000\000\000\021dmap.persistentidmcty\000\000\000\002\000\amdcl\000\000\000,mcnm\000\000\000\004mconmcna\000\000\000\016dmap.containermcty\000\000\000\002\000\fmdcl\000\000\0002mcnm\000\000\000\004mctimcna\000\000\000\024dmap.containeritemidmcty\000\000\000\002\000\005mdcl\000\000\0004mcnm\000\000\000\004mpcomcna\000\000\000\026dmap.parentcontaineridmcty\000\000\000\002\000\005mdcl\000\000\000)mcnm\000\000\000\004msttmcna\000\000\000\vdmap.statusmcty\000\000\000\002\000\005mdcl\000\000\000/mcnm\000\000\000\004mstsmcna\000\000\000\021dmap.statusstringmcty\000\000\000\002\000\tmdcl\000\000\000,mcnm\000\000\000\004mimcmcna\000\000\000\016dmap.itemcountmcty\000\000\000\002\000\005mdcl\000\000\0001mcnm\000\000\000\004mctcmcna\000\000\000\023dmap.containercountmcty\000\000\000\002\000\005mdcl\000\000\0000mcnm\000\000\000\004mrcomcna\000\000\000\022dmap.returnedcountmcty\000\000\000\002\000\005mdcl\000\000\0006mcnm\000\000\000\004mtcomcna\000\000\000\030dmap.specifiedtotalcountmcty\000\000\000\002\000\005mdcl\000\000\0005mcnm\000\000\000\004f\215chmcna\000\000\000\027dmap.haschildcontainersmcty\000\000\000\002\000\001mdcl\000\000\000*mcnm\000\000\000\004mlclmcna\000\000\000\fdmap.listingmcty\000\000\000\002\000\fmdcl\000\000\000.mcnm\000\000\000\004mlitmcna\000\000\000\020dmap.listingitemmcty\000\000\000\002\000\fmdcl\000\000\000&mcnm\000\000\000\004mbclmcna\000\000\000\bdmap.bagmcty\000\000\000\002\000\fmdcl\000\000\000-mcnm\000\000\000\004mdclmcna\000\000\000\017dmap.dictionarymcty\000\000\000\002\000\fmdcl\000\000\0005mcnm\000\000\000\004msrvmcna\000\000\000\027dmap.serverinforesponsemcty\000\000\000\002\000\fmdcl\000\000\0007mcnm\000\000\000\004msaumcna\000\000\000\031dmap.authenticationmethodmcty\000\000\000\002\000\001mdcl\000\000\0008mcnm\000\000\000\004msasmcna\000\000\000\032dmap.authenticationschemesmcty\000\000\000\002\000\005mdcl\000\000\0000mcnm\000\000\000\004mslrmcna\000\000\000\022dmap.loginrequiredmcty\000\000\000\002\000\001mdcl\000\000\0002mcnm\000\000\000\004mpromcna\000\000\000\024dmap.protocolversionmcty\000\000\000\002\000\vmdcl\000\000\0005mcnm\000\000\000\004msalmcna\000\000\000\027dmap.supportsautologoutmcty\000\000\000\002\000\001mdcl\000\000\0001mcnm\000\000\000\004msupmcna\000\000\000\023dmap.supportsupdatemcty\000\000\000\002\000\001mdcl\000\000\0008mcnm\000\000\000\004mspimcna\000\000\000\032dmap.supportspersistentidsmcty\000\000\000\002\000\001mdcl\000\000\0005mcnm\000\000\000\004msexmcna\000\000\000\027dmap.supportsextensionsmcty\000\000\000\002\000\001mdcl\000\000\0001mcnm\000\000\000\004msbrmcna\000\000\000\023dmap.supportsbrowsemcty\000\000\000\002\000\001mdcl\000\000\0000mcnm\000\000\000\004msqymcna\000\000\000\022dmap.supportsquerymcty\000\000\000\002\000\001mdcl\000\000\0000mcnm\000\000\000\004msixmcna\000\000\000\022dmap.supportsindexmcty\000\000\000\002\000\001mdcl\000\000\0002mcnm\000\000\000\004msrsmcna\000\000\000\024dmap.supportsresolvemcty\000\000\000\002\000\001mdcl\000\000\0002mcnm\000\000\000\004mstmmcna\000\000\000\024dmap.timeoutintervalmcty\000\000\000\002\000\005mdcl\000\000\0001mcnm\000\000\000\004msdcmcna\000\000\000\023dmap.databasescountmcty\000\000\000\002\000\005mdcl\000\000\000*mcnm\000\000\000\004mstcmcna\000\000\000\fdmap.utctimemcty\000\000\000\002\000\nmdcl\000\000\000,mcnm\000\000\000\004mstomcna\000\000\000\016dmap.utcoffsetmcty\000\000\000\002\000\006mdcl\000\000\0000mcnm\000\000\000\004mlogmcna\000\000\000\022dmap.loginresponsemcty\000\000\000\002\000\fmdcl\000\000\000,mcnm\000\000\000\004mlidmcna\000\000\000\016dmap.sessionidmcty\000\000\000\002\000\005mdcl\000\000\0001mcnm\000\000\000\004mupdmcna\000\000\000\023dmap.updateresponsemcty\000\000\000\002\000\fmdcl\000\000\0001mcnm\000\000\000\004musrmcna\000\000\000\023dmap.serverrevisionmcty\000\000\000\002\000\005mdcl\000\000\000-mcnm\000\000\000\004mutymcna\000\000\000\017dmap.updatetypemcty\000\000\000\002\000\001mdcl\000\000\0003mcnm\000\000\000\004mudlmcna\000\000\000\025dmap.deletedidlistingmcty\000\000\000\002\000\fmdcl\000\000\0007mcnm\000\000\000\004mccrmcna\000\000\000\031dmap.contentcodesresponsemcty\000\000\000\002\000\fmdcl\000\000\0005mcnm\000\000\000\004mcnmmcna\000\000\000\027dmap.contentcodesnumbermcty\000\000\000\002\000\005mdcl\000\000\0003mcnm\000\000\000\004mcnamcna\000\000\000\025dmap.contentcodesnamemcty\000\000\000\002\000\tmdcl\000\000\0003mcnm\000\000\000\004mctymcna\000\000\000\025dmap.contentcodestypemcty\000\000\000\002\000\003mdcl\000\000\0004mcnm\000\000\000\004atedmcna\000\000\000\026daap.supportsextradatamcty\000\000\000\002\000\003mdcl\000\000\0002mcnm\000\000\000\004apromcna\000\000\000\024daap.protocolversionmcty\000\000\000\002\000\vmdcl\000\000\0002mcnm\000\000\000\004avdbmcna\000\000\000\024daap.serverdatabasesmcty\000\000\000\002\000\fmdcl\000\000\0001mcnm\000\000\000\004abromcna\000\000\000\023daap.databasebrowsemcty\000\000\000\002\000\fmdcl\000\000\0000mcnm\000\000\000\004adbsmcna\000\000\000\022daap.databasesongsmcty\000\000\000\002\000\fmdcl\000\000\0004mcnm\000\000\000\004aplymcna\000\000\000\026daap.databaseplaylistsmcty\000\000\000\002\000\fmdcl\000\000\0000mcnm\000\000\000\004apsomcna\000\000\000\022daap.playlistsongsmcty\000\000\000\002\000\fmdcl\000\000\000*mcnm\000\000\000\004arsvmcna\000\000\000\fdaap.resolvemcty\000\000\000\002\000\fmdcl\000\000\000.mcnm\000\000\000\004arifmcna\000\000\000\020daap.resolveinfomcty\000\000\000\002\000\fmdcl\000\000\0005mcnm\000\000\000\004abalmcna\000\000\000\027daap.browsealbumlistingmcty\000\000\000\002\000\fmdcl\000\000\0006mcnm\000\000\000\004abarmcna\000\000\000\030daap.browseartistlistingmcty\000\000\000\002\000\fmdcl\000\000\0008mcnm\000\000\000\004abcpmcna\000\000\000\032daap.browsecomposerlistingmcty\000\000\000\002\000\fmdcl\000\000\0005mcnm\000\000\000\004abgnmcna\000\000\000\027daap.browsegenrelistingmcty\000\000\000\002\000\fmdcl\000\000\000Bmcnm\000\000\000\004aePPmcna\000\000\000$com.apple.itunes.is-podcast-playlistmcty\000\000\000\002\000\001mdcl\000\000\000,mcnm\000\000\000\004asalmcna\000\000\000\016daap.songalbummcty\000\000\000\002\000\tmdcl\000\000\000-mcnm\000\000\000\004asarmcna\000\000\000\017daap.songartistmcty\000\000\000\002\000\tmdcl\000\000\000.mcnm\000\000\000\004asbrmcna\000\000\000\020daap.songbitratemcty\000\000\000\002\000\003mdcl\000\000\000.mcnm\000\000\000\004ascmmcna\000\000\000\020daap.songcommentmcty\000\000\000\002\000\tmdcl\000\000\0002mcnm\000\000\000\004ascomcna\000\000\000\024daap.songcompilationmcty\000\000\000\002\000\001mdcl\000\000\000/mcnm\000\000\000\004ascpmcna\000\000\000\021daap.songcomposermcty\000\000\000\002\000\tmdcl\000\000\0000mcnm\000\000\000\004asdamcna\000\000\000\022daap.songdateaddedmcty\000\000\000\002\000\nmdcl\000\000\0003mcnm\000\000\000\004asdmmcna\000\000\000\025daap.songdatemodifiedmcty\000\000\000\002\000\nmdcl\000\000\0000mcnm\000\000\000\004asdcmcna\000\000\000\022daap.songdisccountmcty\000\000\000\002\000\003mdcl\000\000\0001mcnm\000\000\000\004asdnmcna\000\000\000\023daap.songdiscnumbermcty\000\000\000\002\000\003mdcl\000\000\000/mcnm\000\000\000\004aseqmcna\000\000\000\021daap.songeqpresetmcty\000\000\000\002\000\tmdcl\000\000\000,mcnm\000\000\000\004asgnmcna\000\000\000\016daap.songgenremcty\000\000\000\002\000\tmdcl\000\000\0002mcnm\000\000\000\004asdtmcna\000\000\000\024daap.songdescriptionmcty\000\000\000\002\000\tmdcl\000\000\0005mcnm\000\000\000\004asrvmcna\000\000\000\027daap.songrelativevolumemcty\000\000\000\002\000\002mdcl\000\000\0001mcnm\000\000\000\004assrmcna\000\000\000\023daap.songsampleratemcty\000\000\000\002\000\005mdcl\000\000\000+mcnm\000\000\000\004asszmcna\000\000\000\rdaap.songsizemcty\000\000\000\002\000\005mdcl\000\000\0000mcnm\000\000\000\004asstmcna\000\000\000\022daap.songstarttimemcty\000\000\000\002\000\005mdcl\000\000\000/mcnm\000\000\000\004asspmcna\000\000\000\021daap.songstoptimemcty\000\000\000\002\000\005mdcl\000\000\000+mcnm\000\000\000\004astmmcna\000\000\000\rdaap.songtimemcty\000\000\000\002\000\005mdcl\000\000\0001mcnm\000\000\000\004astcmcna\000\000\000\023daap.songtrackcountmcty\000\000\000\002\000\003mdcl\000\000\0002mcnm\000\000\000\004astnmcna\000\000\000\024daap.songtracknumbermcty\000\000\000\002\000\003mdcl\000\000\0001mcnm\000\000\000\004asurmcna\000\000\000\023daap.songuserratingmcty\000\000\000\002\000\001mdcl\000\000\000+mcnm\000\000\000\004asyrmcna\000\000\000\rdaap.songyearmcty\000\000\000\002\000\003mdcl\000\000\000-mcnm\000\000\000\004asfmmcna\000\000\000\017daap.songformatmcty\000\000\000\002\000\tmdcl\000\000\000+mcnm\000\000\000\004minmmcna\000\000\000\rdmap.itemnamemcty\000\000\000\002\000\tmdcl\000\000\000/mcnm\000\000\000\004asdbmcna\000\000\000\021daap.songdisabledmcty\000\000\000\002\000\001mdcl\000\000\000:mcnm\000\000\000\004aeNVmcna\000\000\000\034com.apple.itunes.norm-volumemcty\000\000\000\002\000\005mdcl\000\000\000=mcnm\000\000\000\004aeSPmcna\000\000\000\037com.apple.itunes.smart-playlistmcty\000\000\000\002\000\001mdcl\000\000\000/mcnm\000\000\000\004asdkmcna\000\000\000\021daap.songdatakindmcty\000\000\000\002\000\001mdcl\000\000\000.mcnm\000\000\000\004asulmcna\000\000\000\020daap.songdataurlmcty\000\000\000\002\000\tmdcl\000\000\0005mcnm\000\000\000\004asbtmcna\000\000\000\027daap.songbeatsperminutemcty\000\000\000\002\000\003mdcl\000\000\000/mcnm\000\000\000\004abplmcna\000\000\000\021daap.baseplaylistmcty\000\000\000\002\000\001mdcl\000\000\000/mcnm\000\000\000\004agrpmcna\000\000\000\021daap.songgroupingmcty\000\000\000\002\000\tmdcl\000\000\000:mcnm\000\000\000\004aeSImcna\000\000\000\034com.apple.itunes.itms-songidmcty\000\000\000\002\000\005mdcl\000\000\000<mcnm\000\000\000\004aeAImcna\000\000\000\036com.apple.itunes.itms-artistidmcty\000\000\000\002\000\005mdcl\000\000\000>mcnm\000\000\000\004aePImcna\000\000\000 com.apple.itunes.itms-playlistidmcty\000\000\000\002\000\005mdcl\000\000\000>mcnm\000\000\000\004aeCImcna\000\000\000 com.apple.itunes.itms-composeridmcty\000\000\000\002\000\005mdcl\000\000\000;mcnm\000\000\000\004aeGImcna\000\000\000\035com.apple.itunes.itms-genreidmcty\000\000\000\002\000\005mdcl\000\000\0000mcnm\000\000\000\004ascdmcna\000\000\000\022daap.songcodectypemcty\000\000\000\002\000\005mdcl\000\000\0003mcnm\000\000\000\004ascsmcna\000\000\000\025daap.songcodecsubtypemcty\000\000\000\002\000\005mdcl\000\000\000@mcnm\000\000\000\004aeSFmcna\000\000\000\"com.apple.itunes.itms-storefrontidmcty\000\000\000\002\000\005mdcl\000\000\0006mcnm\000\000\000\004apsmmcna\000\000\000\030daap.playlistshufflemodemcty\000\000\000\002\000\001mdcl\000\000\0005mcnm\000\000\000\004aprmmcna\000\000\000\027daap.playlistrepeatmodemcty\000\000\000\002\000\001mdcl\000\000\0009mcnm\000\000\000\004aePCmcna\000\000\000\ecom.apple.itunes.is-podcastmcty\000\000\000\002\000\001mdcl\000\000\000/mcnm\000\000\000\004asctmcna\000\000\000\021daap.songcategorymcty\000\000\000\002\000\tmdcl\000\000\0009mcnm\000\000\000\004ascnmcna\000\000\000\edaap.songcontentdescriptionmcty\000\000\000\002\000\tmdcl\000\000\000=mcnm\000\000\000\004aslcmcna\000\000\000\037daap.songlongcontentdescriptionmcty\000\000\000\002\000\tmdcl\000\000\000/mcnm\000\000\000\004askymcna\000\000\000\021daap.songkeywordsmcty\000\000\000\002\000\tmdcl\000\000\0004mcnm\000\000\000\004ascrmcna\000\000\000\026daap.songcontentratingmcty\000\000\000\002\000\001mdcl\000\000\0008mcnm\000\000\000\004aeHVmcna\000\000\000\032com.apple.itunes.has-videomcty\000\000\000\002\000\001mdcl\000\000\0008mcnm\000\000\000\004aeMKmcna\000\000\000\032com.apple.itunes.mediakindmcty\000\000\000\002\000\001mdcl\000\000\000:mcnm\000\000\000\004aeSNmcna\000\000\000\034com.apple.itunes.series-namemcty\000\000\000\002\000\tmdcl\000\000\000;mcnm\000\000\000\004aeNNmcna\000\000\000\035com.apple.itunes.network-namemcty\000\000\000\002\000\tmdcl\000\000\000>mcnm\000\000\000\004aeENmcna\000\000\000 com.apple.itunes.episode-num-strmcty\000\000\000\002\000\tmdcl\000\000\000;mcnm\000\000\000\004aeESmcna\000\000\000\035com.apple.itunes.episode-sortmcty\000\000\000\002\000\005mdcl\000\000\0009mcnm\000\000\000\004aeSUmcna\000\000\000\ecom.apple.itunes.season-nummcty\000\000\000\002\000\005mdcl\000\000\000;mcnm\000\000\000\004aeGHmcna\000\000\000\035com.apple.itunes.gapless-heurmcty\000\000\000\002\000\005mdcl\000\000\0002mcnm\000\000\000\004asaamcna\000\000\000\024daap.songalbumartistmcty\000\000\000\002\000\tmdcl\000\000\000=mcnm\000\000\000\004aeGDmcna\000\000\000\037com.apple.itunes.gapless-enc-drmcty\000\000\000\002\000\005mdcl\000\000\000:mcnm\000\000\000\004aeGUmcna\000\000\000\034com.apple.itunes.gapless-durmcty\000\000\000\002\000\amdcl\000\000\000;mcnm\000\000\000\004aeGRmcna\000\000\000\035com.apple.itunes.gapless-resymcty\000\000\000\002\000\amdcl\000\000\000>mcnm\000\000\000\004aeGEmcna\000\000\000 com.apple.itunes.gapless-enc-delmcty\000\000\000\002\000\005mdcl\000\000\0008mcnm\000\000\000\004\000\000\000\000mcna\000\000\000\032com.apple.itunes.req-fplaymcty\000\000\000\002\000\001mdcl\000\000\000.mcnm\000\000\000\004asgpmcna\000\000\000\020daap.songgaplessmcty\000\000\000\002\000\001mdcl\000\000\000?mcnm\000\000\000\004aePSmcna\000\000\000!com.apple.itunes.special-playlistmcty\000\000\000\002\000\001mdcl\000\000\0000mcnm\000\000\000\004asedmcna\000\000\000\022daap.songextradatamcty\000\000\000\002\000\003mdcl\000\000\0003mcnm\000\000\000\004asdrmcna\000\000\000\025daap.songdatereleasedmcty\000\000\000\002\000\nmdcl\000\000\0004mcnm\000\000\000\004asdpmcna\000\000\000\026daap.songdatepurchasedmcty\000\000\000\002\000\nmdcl\000\000\0004mcnm\000\000\000\004ashpmcna\000\000\000\026daap.songhasbeenplayedmcty\000\000\000\002\000\001mdcl\000\000\000+mcnm\000\000\000\004assnmcna\000\000\000\rdaap.sortnamemcty\000\000\000\002\000\tmdcl\000\000\000-mcnm\000\000\000\004assamcna\000\000\000\017daap.sortartistmcty\000\000\000\002\000\tmdcl\000\000\0002mcnm\000\000\000\004asslmcna\000\000\000\024daap.sortalbumartistmcty\000\000\000\002\000\tmdcl\000\000\000,mcnm\000\000\000\004assumcna\000\000\000\016daap.sortalbummcty\000\000\000\002\000\tmdcl\000\000\000/mcnm\000\000\000\004asscmcna\000\000\000\021daap.sortcomposermcty\000\000\000\002\000\tmdcl\000\000\0001mcnm\000\000\000\004asssmcna\000\000\000\023daap.sortseriesnamemcty\000\000\000\002\000\tmdcl\000\000\000/mcnm\000\000\000\004asbkmcna\000\000\000\021daap.bookmarkablemcty\000\000\000\002\000\001mdcl\000\000\000/mcnm\000\000\000\004asbomcna\000\000\000\021daap.songbookmarkmcty\000\000\000\002\000\005mdcl\000\000\0001mcnm\000\000\000\004aspumcna\000\000\000\023daap.songpodcasturlmcty\000\000\000\002\000\tmdcl\000\000\000=mcnm\000\000\000\004aeCRmcna\000\000\000\037com.apple.itunes.content-ratingmcty\000\000\000\002\000\tmdcl\000\000\000.mcnm\000\000\000\004asaimcna\000\000\000\020daap.songalbumidmcty\000\000\000\002\000\amdcl\000\000\000/mcnm\000\000\000\004aslsmcna\000\000\000\021daap.songlongsizemcty\000\000\000\002\000\amdcl\000\000\000;mcnm\000\000\000\004aeSGmcna\000\000\000\035com.apple.itunes.saved-geniusmcty\000\000\000\002\000\001mdcl\000\000\0008mcnm\000\000\000\004medsmcna\000\000\000\032dmap.editcommandssupportedmcty\000\000\000\002\000\005mdcl\000\000\000:mcnm\000\000\000\004aeHDmcna\000\000\000\034com.apple.itunes.is-hd-videomcty\000\000\000\002\000\001mdcl\000\000\000;mcnm\000\000\000\004ceJVmcna\000\000\000\035com.apple.itunes.jukebox-votemcty\000\000\000\002\000\005mdcl\000\000\000Bmcnm\000\000\000\004ceJCmcna\000\000\000$com.apple.itunes.jukebox-client-votemcty\000\000\000\002\000\002mdcl\000\000\000<mcnm\000\000\000\004ceJSmcna\000\000\000\036com.apple.itunes.jukebox-scoremcty\000\000\000\002\000\004mdcl\000\000\000>mcnm\000\000\000\004ceJImcna\000\000\000 com.apple.itunes.jukebox-currentmcty\000\000\000\002\000\005mdcl\000\000\000Dmcnm\000\000\000\004aeSVmcna\000\000\000&com.apple.itunes.music-sharing-versionmcty\000\000\000\002\000\005"
      
      n = @dmap.parse(data)
      puts n.to_s
    end
  end
end